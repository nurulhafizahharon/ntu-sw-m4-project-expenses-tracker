version: 2.1
orbs:
  docker: circleci/docker@2.1.4
  snyk: snyk/snyk@1.5.0
  heroku: circleci/heroku@2.0.0

jobs:
  build:
    docker:
      - image: cimg/openjdk:17.0
    steps:
      - checkout
      - run:
          name: Build
          command: mvn -B -DskipTests clean package
      - run:
          name: Test
          command: |
            mvn test -Dtest="ExpenseControllerTest#createExpenseTest"

  test:
    docker:
      - image: cimg/openjdk:17.0
    steps:
      - checkout
      - run:
          name: Test
          command: |
            mvn test -Dtest="ExpenseControllerTest#createExpenseTest"
            mvn test -Dtest="ExpenseControllerTest#getAllExpenseByWalletTest"
            mvn test -Dtest="ExpenseControllerTest#updateExpenseTest"
            
workflow:
  ci-workflow:
    jobs:
      - build:
          filters:
            branches:
              only: develop
      # - test:
      #     # requires:
      #     #   - build
      #     filters:
      #       branches:
      #         only: develop
